<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <title>World Clock - Enhanced Edition</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
</head>

<body>
    <!-- Background animation -->
    <div class="bg-animation" id="bgAnimation"></div>

    <div class="container">
        <h1>üåç World Clock</h1>

        <div class="clock-container">
            <div id="clock">--:--:--</div>
            <div id="date">Loading...</div>
            <div id="timezone-info">Local Time</div>
        </div>

        <div class="slideshow-container">
            <div class="slideshow-title">Select a Country</div>

            <div class="slide-wrapper">
                <button class="nav-arrow prev" onclick="showSlide(index - 1)">
                    ‚Äπ
                </button>
                <button class="nav-arrow next" onclick="showSlide(index + 1)">
                    ‚Ä∫
                </button>

                <div class="slides" id="slides">
                    <img src="assets/Ind.png" alt="India" data-zone="Asia/Kolkata"
                        data-country="India" />
                    <img src="assets/Usa.png" alt="USA" data-zone="America/New_York"
                        data-country="United States" />
                    <img src="assets/Uk.png" alt="UK" data-zone="Europe/London"
                        data-country="United Kingdom" />
                    <img src="assets/Jpn.png" alt="Japan" data-zone="Asia/Tokyo"
                        data-country="Japan" />
                    <img src="assets/Aus.png" alt="Australia" data-zone="Australia/Sydney"
                        data-country="Australia" />
                </div>

                <div class="country-overlay">
                    <div class="country-name" id="countryName">Select Country</div>
                    <div class="country-time" id="countryTime">Local Time Zone</div>
                </div>
            </div>

            <div class="dots-container">
                <div class="dots" id="dots"></div>
            </div>

            <div class="autoplay-indicator">
                <span>Auto-play:</span>
                <button class="play-pause-btn" id="playPauseBtn" onclick="toggleAutoplay()">
                    Pause
                </button>
            </div>
        </div>

        <footer>
            <div>
                Click, swipe, or use arrow keys to explore different time zones
            </div>
            <div class="footer-links">
                <a href="#" onclick="showSlide(0)">üá∫üá∏ USA</a>
                <a href="#" onclick="showSlide(2)">üáÆüá≥ India</a>
                <a href="#" onclick="showSlide(3)">üáØüáµ Japan</a>
            </div>
        </footer>
    </div>

    <script>
        // Global variables
        let currentZone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        const slides = document.getElementById("slides");
        const dots = document.getElementById("dots");
        const countryName = document.getElementById("countryName");
        const countryTime = document.getElementById("countryTime");
        const timezoneInfo = document.getElementById("timezone-info");
        const playPauseBtn = document.getElementById("playPauseBtn");

        const total = slides.children.length;
        let index = 0;
        let autoplayInterval;
        let isAutoplay = true;

        // Clock functionality
        function updateClock() {
            const now = new Date();

            try {
                const timeFormat = new Intl.DateTimeFormat("en-US", {
                    hour: "2-digit",
                    minute: "2-digit",
                    second: "2-digit",
                    hour12: false,
                    timeZone: currentZone,
                });

                const dateFormat = new Intl.DateTimeFormat("en-US", {
                    weekday: "long",
                    year: "numeric",
                    month: "long",
                    day: "2-digit",
                    timeZone: currentZone,
                });

                document.getElementById("clock").textContent = timeFormat.format(now);
                document.getElementById("date").textContent = dateFormat.format(now);

                // Update timezone info
                const currentSlide = slides.children[index];
                const zoneName = currentSlide.dataset.zone;
                const countryNameText = currentSlide.dataset.country;

                timezoneInfo.textContent = `${countryNameText} Time (${zoneName})`;
                countryName.textContent = countryNameText;
                countryTime.textContent = `Time Zone: ${zoneName}`;
            } catch (error) {
                console.error("Error updating clock:", error);
                document.getElementById("clock").textContent = "Error";
                document.getElementById("date").textContent = "Unable to load time";
            }
        }

        // Slideshow functionality
        function createDots() {
            dots.innerHTML = "";
            for (let i = 0; i < total; i++) {
                const dot = document.createElement("span");
                if (i === 0) dot.classList.add("active");
                dot.onclick = () => showSlide(i);
                dot.setAttribute(
                    "aria-label",
                    `Show ${slides.children[i].dataset.country}`
                );
                dots.appendChild(dot);
            }
        }

        function showSlide(i) {
            index = ((i % total) + total) % total;

            // Update slide position
            slides.style.transform = `translateX(-${index * 320}px)`;

            // Update dots
            document.querySelector(".dots .active")?.classList.remove("active");
            dots.children[index].classList.add("active");

            // Update timezone
            currentZone = slides.children[index].dataset.zone;
            updateClock();

            // Reset autoplay
            if (isAutoplay) {
                clearInterval(autoplayInterval);
                startAutoplay();
            }
        }

        function startAutoplay() {
            autoplayInterval = setInterval(() => {
                showSlide(index + 1);
            }, 4000);
        }

        function toggleAutoplay() {
            isAutoplay = !isAutoplay;
            if (isAutoplay) {
                startAutoplay();
                playPauseBtn.textContent = "Pause";
            } else {
                clearInterval(autoplayInterval);
                playPauseBtn.textContent = "Play";
            }
        }

        // Touch/swipe functionality
        let startX = 0;
        let isDragging = false;

        slides.addEventListener("pointerdown", (e) => {
            startX = e.clientX;
            isDragging = true;
            slides.style.cursor = "grabbing";
        });

        slides.addEventListener("pointermove", (e) => {
            if (!isDragging) return;
            e.preventDefault();
        });

        slides.addEventListener("pointerup", (e) => {
            if (!isDragging) return;
            isDragging = false;
            slides.style.cursor = "grab";

            const dx = e.clientX - startX;
            if (Math.abs(dx) > 50) {
                showSlide(index + (dx < 0 ? 1 : -1));
            }
        });

        // Keyboard navigation
        document.addEventListener("keydown", (e) => {
            switch (e.key) {
                case "ArrowLeft":
                    showSlide(index - 1);
                    break;
                case "ArrowRight":
                    showSlide(index + 1);
                    break;
                case " ":
                    e.preventDefault();
                    toggleAutoplay();
                    break;
            }
        });

        // Background animation
        function createBackgroundAnimation() {
            const bgAnimation = document.getElementById("bgAnimation");
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement("div");
                particle.classList.add("particle");
                particle.style.left = Math.random() * 100 + "%";
                particle.style.top = Math.random() * 100 + "%";
                particle.style.animationDelay = Math.random() * 6 + "s";
                particle.style.animationDuration = Math.random() * 3 + 3 + "s";
                bgAnimation.appendChild(particle);
            }
        }

        // Initialize everything
        function init() {
            createDots();
            createBackgroundAnimation();
            updateClock();
            startAutoplay();

            setInterval(updateClock, 1000);

            // Show initial slide
            showSlide(0);
        }

        // Start when page loads
        document.addEventListener("DOMContentLoaded", init);

        // Handle visibility change (pause when tab is hidden)
        document.addEventListener("visibilitychange", () => {
            if (document.hidden) {
                clearInterval(autoplayInterval);
            } else if (isAutoplay) {
                startAutoplay();
            }
        });
    </script>
</body>

</html>